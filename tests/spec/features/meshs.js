describe('Test MeSHs feature', function() {

    var originalTimeout;

    beforeEach(function() {
        originalTimeout = jasmine.DEFAULT_TIMEOUT_INTERVAL;
        jasmine.DEFAULT_TIMEOUT_INTERVAL = 20000;

        // Wait store load
        setTimeout(function() {
            var ctrlGenericGrid = MetExplore.app.getController('MetExplore.controller.C_GenericGrid');
            ctrlGenericGrid.selectBioSource("1363");
        }, 5000);
    });

    afterEach(function() {
        jasmine.DEFAULT_TIMEOUT_INTERVAL = originalTimeout;
    });

    it('Test inchlib init', function() {
        expect(InCHlib).toBeDefined();
    });

    it('Test inchlib sorting', function(done) {
        Ext.getCmp('mappingVizPanel').show();
        var mapping = {
            "name": "Metab2MeSH 3",
            "id": "M3",
            "data": {
                "meSHFromMetab4InCHlib": {
                    "metadata": {
                        "nodes": {
                            "panelViz#panelViz#0": ["4", "1.0"],
                            "panelViz#panelViz#1": ["9", "4.0"],
                            "panelViz#panelViz#2": ["8", "0.0"]
                        },
                        "feature_names": ["Number of metabolites", "Articles ratio"]
                    },
                    "data": {
                        "nodes": {
                            "panelViz#panelViz#0": {
                                "features": [0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0],
                                "parent": "panelViz#panelViz#3",
                                "distance": 0,
                                "objects": ["Parkinson Disease"],
                                "count": 1
                            },
                            "panelViz#panelViz#1": {
                                "features": [0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                "parent": "panelViz#panelViz#4",
                                "distance": 0,
                                "objects": ["Hepatic Encephalopathy"],
                                "count": 1
                            },
                            "panelViz#panelViz#2": {
                                "features": [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0],
                                "parent": "panelViz#panelViz#3",
                                "distance": 0,
                                "objects": ["Alzheimer Disease"],
                                "count": 1
                            },
                            "panelViz#panelViz#3": {
                                "parent": "panelViz#panelViz#4",
                                "left_child": "panelViz#panelViz#0",
                                "distance": 2.449,
                                "right_child": "panelViz#panelViz#2",
                                "count": 2
                            },
                            "panelViz#panelViz#4": {
                                "left_child": "panelViz#panelViz#1",
                                "distance": 2.708,
                                "right_child": "panelViz#panelViz#3",
                                "count": 3
                            }
                        },
                        "feature_names": ["L-threonine", "5-oxoprolinate", "L-kynurenine", "5-hydroxy-L-tryptophan", "O-acetylcarnitine", "L-methionine", "L-glutamate(1-)", "5-Hydroxyindoleacetate", "L-tyrosine", "L-Octanoylcarnitine", "L-phenylalanine", "L-tryptophan", "citr_L[e]"]
                    },
                    "column_dendrogram": {
                        "nodes": {
                            "panelViz#panelViz#0": {
                                "parent": "panelViz#panelViz#13",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#1": {
                                "parent": "panelViz#panelViz#22",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#2": {
                                "parent": "panelViz#panelViz#20",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#3": {
                                "parent": "panelViz#panelViz#13",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#4": {
                                "parent": "panelViz#panelViz#14",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#5": {
                                "parent": "panelViz#panelViz#15",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#6": {
                                "parent": "panelViz#panelViz#15",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#7": {
                                "parent": "panelViz#panelViz#20",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#8": {
                                "parent": "panelViz#panelViz#16",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#9": {
                                "parent": "panelViz#panelViz#17",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#10": {
                                "parent": "panelViz#panelViz#16",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#11": {
                                "parent": "panelViz#panelViz#18",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#12": {
                                "parent": "panelViz#panelViz#19",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#13": {
                                "parent": "panelViz#panelViz#14",
                                "left_child": "panelViz#panelViz#0",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#3",
                                "count": 2
                            },
                            "panelViz#panelViz#14": {
                                "parent": "panelViz#panelViz#17",
                                "left_child": "panelViz#panelViz#4",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#13",
                                "count": 3
                            },
                            "panelViz#panelViz#15": {
                                "parent": "panelViz#panelViz#19",
                                "left_child": "panelViz#panelViz#5",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#6",
                                "count": 2
                            },
                            "panelViz#panelViz#16": {
                                "parent": "panelViz#panelViz#18",
                                "left_child": "panelViz#panelViz#8",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#10",
                                "count": 2
                            },
                            "panelViz#panelViz#17": {
                                "parent": "panelViz#panelViz#24",
                                "left_child": "panelViz#panelViz#9",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#14",
                                "count": 4
                            },
                            "panelViz#panelViz#18": {
                                "parent": "panelViz#panelViz#21",
                                "left_child": "panelViz#panelViz#11",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#16",
                                "count": 3
                            },
                            "panelViz#panelViz#19": {
                                "parent": "panelViz#panelViz#22",
                                "left_child": "panelViz#panelViz#12",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#15",
                                "count": 3
                            },
                            "panelViz#panelViz#20": {
                                "parent": "panelViz#panelViz#21",
                                "left_child": "panelViz#panelViz#2",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#7",
                                "count": 2
                            },
                            "panelViz#panelViz#21": {
                                "parent": "panelViz#panelViz#23",
                                "left_child": "panelViz#panelViz#18",
                                "distance": 1.549,
                                "right_child": "panelViz#panelViz#20",
                                "count": 5
                            },
                            "panelViz#panelViz#22": {
                                "parent": "panelViz#panelViz#23",
                                "left_child": "panelViz#panelViz#1",
                                "distance": 1.732,
                                "right_child": "panelViz#panelViz#19",
                                "count": 4
                            },
                            "panelViz#panelViz#23": {
                                "parent": "panelViz#panelViz#24",
                                "left_child": "panelViz#panelViz#21",
                                "distance": 2.295,
                                "right_child": "panelViz#panelViz#22",
                                "count": 9
                            },
                            "panelViz#panelViz#24": {
                                "left_child": "panelViz#panelViz#17",
                                "distance": 2.562,
                                "right_child": "panelViz#panelViz#23",
                                "count": 13
                            }
                        }
                    }
                },
                "pubmed": {
                    "metabolites": [{
                        "name": "L-phenylalanine",
                        "iupac": "L-phenylalanine",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [7532208, 73858, 2330597, 11092576, 6424488, 101451, 710854, 864384, 573062, 1404890, 1577224, 730076, 7428585, 399583, 5411272, 8514271, 2302019, 807982, 110563, 2517893, 1352048, 8480740, 7095369, 6793024, 7643101, 4134293, 11490371, 4817189, 333224, 4612790, 4612663, 90864, 6127593, 4722749, 741885, 7117780, 3784065, 3926594, 113592, 6797341, 47485],
                            "stats": {
                                "chiSquare": 69.941783736096,
                                "fisherExact": 4.1383048818721e-11,
                                "fover": 3.412890391345,
                                "qValue": 2.1770625765323e-8
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "5-hydroxy-L-tryptophan",
                        "iupac": "5-hydroxy-L-tryptophan",
                        "meshs": [{
                            "identifier": "D010300",
                            "documentSet": [4936139, 10773222, 5312403, 3484854, 9295177, 6814755, 5311767, 3538162, 201156, 4538893, 11685243, 4403657, 6997735, 2428139, 5308096, 5308739, 2265910, 6801200, 1918474, 6999, 787922, 4563493, 2461509, 4546593, 4401063, 5310324, 4541856, 9182250, 4548770, 4574253, 4923106, 4604074, 4134163, 4358575, 4944741, 772708, 7682308, 4280243, 4098060, 4889342, 2962265, 3493632, 1079721, 5316906, 1080107, 8101703, 4590072, 4226878],
                            "stats": {
                                "chiSquare": 128.01283662306,
                                "fisherExact": 6.9948837140476e-17,
                                "fover": 4.4418001491716,
                                "qValue": 5.3974606466477e-14
                            },
                            "name": "Parkinson Disease"
                        }]
                    }, {
                        "name": "L-methionine",
                        "iupac": "L-methionine",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [5050317, 6516898, 4932106, 21483460, 908872, 14146640, 6394027, 6107671, 101451, 2993889, 1079900, 1999315, 864384, 573062, 1404890, 335882, 6985598, 1155716, 685343, 347920, 5444996, 121878, 3168296, 3710497, 3114036, 6286400, 4829865, 807982, 3912338, 4134293, 6698445, 1529276, 4817189, 3736469, 14174581, 333224, 7106499, 109939, 2857496, 6127593, 741885, 6519636, 113592, 6797341, 47485],
                            "stats": {
                                "chiSquare": 69.942806612549,
                                "fisherExact": 2.3947581895503e-11,
                                "fover": 3.2462354646765,
                                "qValue": 1.2840409722323e-8
                            },
                            "name": "Hepatic Encephalopathy"
                        }, {
                            "identifier": "D000544",
                            "documentSet": [15809266, 10535332, 18387741, 10588580, 23399523, 18468894, 16298495, 15605990, 11795896, 22918225, 15843069, 9712537, 22531416, 20209467, 17413657, 20613678, 16517609, 22573634, 15843052, 16627933, 15635660, 12611557, 15505374, 14730194, 22890094, 10096041, 8838581, 8621744, 15680219, 7890753, 21297272, 17169464, 16472763, 17657167, 9007311, 9746908, 1534813, 11228134, 22059533, 17691219, 23769397, 22500616, 15622541, 12198111, 1661822, 22045496, 7991571, 12446928, 12446930, 18460776, 22584618, 15838855, 15970929, 14580313, 3574449, 22150111, 12607822, 10097173, 2116015, 7715815, 19854267, 23249141, 16917144, 15172733, 15172732, 15172731, 1535413, 16248658, 16839078, 17101228, 8224467, 19504537, 10507025, 14520676, 20555139, 15025502, 20453509, 1649369, 15203119, 15706662, 18804692, 20164095, 20590839, 8239282, 19924451, 12752408, 8131745, 17046756, 16962786, 19061952, 10509380, 11403592, 8621419, 12128086, 21054384, 18439912, 8098953, 16837108, 14599209, 23445400, 7798921],
                            "stats": {
                                "chiSquare": 25.202932137765,
                                "fisherExact": 0.0000036623565035302,
                                "fover": 1.6396463781627,
                                "qValue": 0.0011295975774346
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }, {
                        "name": "L-Octanoylcarnitine",
                        "iupac": "L-Octanoylcarnitine",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [8194797, 2805707, 2703758, 2813970, 6097201, 8611661, 7118066, 6693016, 3033057],
                            "stats": {
                                "chiSquare": 131.46576488545,
                                "fisherExact": 6.7509466673616e-9,
                                "fover": 16.546872829518,
                                "qValue": 0.0000028987915722408
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "L-tryptophan",
                        "iupac": "L-tryptophan",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [2419500, 467210, 7685732, 396563, 6848895, 10916286, 12171172, 1763335, 5921860, 10522754, 807982, 7095369, 39973, 7075404, 6793024, 4608353, 15094220, 447020, 14058237, 107058, 12220301, 3791875, 6200419, 8887992, 676917, 3693432, 35649, 2430055, 48706, 18333523, 6244122, 101451, 6342443, 620892, 9652676, 676688, 3747417, 2302019, 1352048, 49767, 14140862, 4817189, 6160435, 6184497, 2158415, 2973276, 966012, 7216152, 48764, 47485, 9869330, 9588757, 1141919, 573062, 7428585, 9286423, 5411272, 2517893, 3912338, 781986, 7098049, 333224, 8906295, 8906294, 6111214, 290743, 6127593, 10164, 4590835, 7454151, 10721051, 16215883, 8869946, 6793946, 10721053, 6162912, 10721052, 382661, 7532208, 426181, 6394027, 710849, 2993889, 26572, 33231, 53461, 33494, 5444996, 399583, 6622904, 4829865, 5122221, 17169376, 17712616, 2793414, 7675013, 4612790, 90864, 14567468, 11137885, 4009921],
                            "stats": {
                                "chiSquare": 452.30134350369,
                                "fisherExact": 1.9251697607781e-46,
                                "fover": 6.3200033598141,
                                "qValue": 3.7346492172426e-43
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "5-oxoprolinate",
                        "iupac": "L-Pyroglutamic acid",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [21900558, 23001756, 20864186, 12354296, 23747948, 19518051, 11027491, 20971852, 21148560, 20833262, 22232007, 22064070, 1904138, 22375951, 19781815, 18570439, 22267726, 19545911, 22712644, 11162251, 21301857, 8971693, 22001577, 21965666, 20383514, 9224700, 23481684, 18836460, 22343072, 22800366, 22269161, 21787313, 19823761, 3090448],
                            "stats": {
                                "chiSquare": 115.13713675152,
                                "fisherExact": 2.7933470168397e-14,
                                "fover": 5.1938510100396,
                                "qValue": 1.8497259704969e-11
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }, {
                        "name": "L-threonine",
                        "iupac": "L-threonine",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [18187157, 16298235, 12196665, 11310639, 10614182, 20683187, 16801675, 20558388, 20033852, 15157994, 11517218, 15126504, 19584443, 16262633, 8793108, 18987186, 16399209, 1644173, 10863026, 12962909, 19363261, 14665412, 21433051, 21883216, 12562590, 9546672, 8835879, 17250725, 19524111, 15488330, 16443603, 15312964, 19307538, 19011737, 11118482, 11146006, 16554819, 11882743, 12759172, 17183681, 15936948, 19770469, 18005339, 12614922, 12164722, 9085254, 15126697, 16738478, 17431643, 22112898, 18508489, 10677623, 15316799, 15272895, 9357016, 20126313, 14575236, 18045903, 8131745, 7786411, 19296504, 16257959, 16705182, 16195223, 17906291, 10341243, 21123754, 8621419, 21220649, 15883264, 21712440, 17448572, 15838855, 16364302, 21084733, 16697218, 15635602],
                            "stats": {
                                "chiSquare": 126.84250302093,
                                "fisherExact": 5.4965376658283e-19,
                                "fover": 3.3486801143319,
                                "qValue": 4.7253567312869e-16
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }, {
                        "name": "O-acetylcarnitine",
                        "iupac": "Acetyl-L-carnitine",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [22027664, 18042001, 2630254, 1444880, 12841930, 12661320, 15591008, 7908343, 21978079, 19185780, 20359271, 11126392, 9677506, 15236794, 17210450, 2178869, 19342064, 18646596, 1630720, 1944900, 8797468, 2690098, 8477148, 1541322, 12598816, 12804452, 23072393, 14624946, 7723928, 16634066, 8666027, 2121359, 8380879, 16402761, 18761385, 10994000, 10608918, 8239306, 1482095, 2792144, 16621446, 1776743, 11171924, 6345054],
                            "stats": {
                                "chiSquare": 629.2547496674,
                                "fisherExact": 1.234647728404e-37,
                                "fover": 16.239666692131,
                                "qValue": 1.9791325489379e-34
                            },
                            "name": "Alzheimer Disease"
                        }, {
                            "identifier": "D006501",
                            "documentSet": [23389620, 20359271, 19357525, 18357530, 21870121, 21310833, 21443422, 17080254, 16445703],
                            "stats": {
                                "chiSquare": 115.45562366204,
                                "fisherExact": 1.7872395525234e-8,
                                "fover": 14.760654957833,
                                "qValue": 0.0000073443025849571
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "5-Hydroxyindoleacetate",
                        "iupac": "5-Hydroxyindole-3-acetic acid",
                        "meshs": [{
                            "identifier": "D010300",
                            "documentSet": [5668438, 5151306, 4261957, 22902616, 6204498, 2435113, 4844103, 942621, 874521, 1705999, 4712542, 827925, 2428421, 11109003, 1091122, 4114458, 2424323, 2409485, 15159499, 5436031, 745018, 6198888, 4845694, 2581531, 6173792, 4262400, 2456674, 7527483, 4715017, 4120687, 4109932, 4282386, 11144958, 2578558, 2446463, 4563493, 10078971, 4546593, 591981, 2475587, 138340, 138341, 4836896, 2421838, 130667, 1372794, 7505410, 4792890, 968312, 6159908, 5658324, 1690267, 2579626, 4666057, 2579625, 570014, 5083866, 134293, 4668639, 15133823, 10078727, 727726, 2581135, 5084388, 11697688, 4858086, 4117647, 1716905, 5556449, 5571307, 18164694, 4281484, 9620060, 9546335, 2428139, 4275348, 6175872, 4616856, 5062828, 2420928, 4270247, 5061285, 4912291, 132845, 4643007, 2480863, 1700581, 1700583, 6172833, 4854088, 20945980, 4785998, 2582318, 2475820, 1146650, 1693975, 4556618, 5580101, 5032285, 5308739, 6182730, 20347948, 4279131, 577299, 907536, 6172024, 4550499, 2435855, 2439947, 6206831, 4763001, 1146660, 9608612, 1080107, 17956909, 11430895, 4270339, 4121468, 5311767, 6085395, 2476906, 5534981, 5133599, 4557584, 4746526, 1283403, 4821783, 6035772, 2461509, 1723256, 5146413, 5892413, 6192438, 5132580, 4716845, 5949239, 1096575, 7682308, 4371255, 8811504, 4930867, 1222507, 5450542, 241026, 4448192, 6164951, 2423726, 1705356, 17973898, 4257247, 6157311, 4699106, 147372, 930747, 4256760, 21376255, 862646, 19844754, 5808100, 4210686, 1088942, 6200801, 569783, 141763, 5312403, 2480103, 1712088, 9295177, 2476003, 201156, 18207455, 4653961, 5424003, 4553111, 4263829, 4125162, 1378766, 5281200, 4930475, 7521168, 1688571, 2421191, 8684384, 4565920, 4541856, 9617786, 4472237, 1374203, 5588903, 4280243, 4822972, 6161320, 843258, 7688076, 8836986, 2482649, 1718247, 9184114],
                            "stats": {
                                "chiSquare": 1304.8857169267,
                                "fisherExact": 2.884803396916e-111,
                                "fover": 8.4723002031853,
                                "qValue": 1.2115802570343e-107
                            },
                            "name": "Parkinson Disease"
                        }, {
                            "identifier": "D000544",
                            "documentSet": [16182262, 7690228, 1710105, 2478368, 2440994, 83462, 2419502, 14671188, 6084823, 2440238, 6204498, 6208336, 6200784, 2579625, 2481322, 2428341, 33427, 10666678, 2432177, 2471986, 1001240, 2580668, 15996137, 6085697, 1713799, 2409733, 1705151, 2450445, 2477071, 2434191, 2457353, 1707190, 1697333, 2439947, 16955437, 6204017, 6195313, 1283363, 2436247, 1701291, 6204013, 8800434, 12218255, 2414354, 6205414, 6157799, 1698467, 2581531, 2474777, 2421656, 2480103, 1714776, 1381590, 2461537, 1719135, 1695580, 9678683, 6172950, 2411246, 12411761, 1707735, 7566524, 6184590, 2415092, 2477044, 7679142, 2451190, 2425718, 1712206, 6181768, 2582256, 1691969, 301148, 1378766, 7510447, 1371850, 7539116, 2452858, 2452037, 15665806, 1723256, 1723257, 2462403, 22045496, 1109880, 6203954, 1716470, 9063908, 2445515, 8627315, 9880039, 1709421, 2480863, 1381103, 1281646],
                            "stats": {
                                "chiSquare": 241.10975497487,
                                "fisherExact": 9.2201456582053e-31,
                                "fover": 4.3057498360277,
                                "qValue": 1.2325184584733e-27
                            },
                            "name": "Alzheimer Disease"
                        }, {
                            "identifier": "D006501",
                            "documentSet": [2482533, 35649, 7532208, 2430055, 426181, 9869330, 9588757, 11575864, 6186774, 2419500, 1698704, 1285400, 26572, 6161235, 2472360, 1141919, 7685732, 754526, 9403225, 33494, 676688, 9789710, 12171172, 39973, 9346471, 2412877, 15094220, 9346468, 4817189, 6160435, 6184497, 236851, 8906294, 2448852, 966012, 2480534, 290743, 11137885, 925688, 2426719, 8869946, 6200419, 6162912, 676917],
                            "stats": {
                                "chiSquare": 306.87954886153,
                                "fisherExact": 9.4013437634163e-27,
                                "fover": 8.8616899077342,
                                "qValue": 1.1066250052098e-23
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "citr_L[e]",
                        "iupac": "L-citrulline",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [7909784, 21483460, 5762228, 11606680, 10078035, 2692930, 8474573, 8840235, 7699832, 864384, 18414167, 4999165, 6513111, 1017595, 7192757, 9361940, 3088083, 1795430],
                            "stats": {
                                "chiSquare": 130.60159333483,
                                "fisherExact": 4.4648859956382e-12,
                                "fover": 9.1463103691286,
                                "qValue": 2.5372845665491e-9
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "L-glutamate(1-)",
                        "iupac": "L-glutamic acid",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [12391609, 14664921, 10735269, 20936504, 22992724, 16714485, 16033022, 18431250, 16033023, 22511962, 10428049, 10428048, 20362023, 18648325, 11442356, 12391586, 15201479, 19012867, 17372971, 20193040, 19903243, 19943189, 16828202, 16515283, 19076369, 18483490, 11218066, 22233455, 21914482, 12768511, 23891752, 20961659, 22133015, 17257792, 14501018, 13130383, 15585443, 18042177, 16809810, 19501936, 18183499, 19110209, 11948244, 11142345, 22515507, 11053772, 19833161, 15857305, 15003276, 19339596, 16772755, 16039064, 18376053, 12697263, 12973748, 22515493, 21921084, 17569662, 18053990, 22112551, 15718040, 12973746, 11391701, 12835512, 21389115, 14677087, 15949941, 21880261, 19221420, 10875439, 18950575, 17433503, 14980721, 20345761, 20444591, 23776240, 12501538, 16802718, 19850126, 22015470, 23156675, 11483660, 22710270, 10627591, 11825682, 15304259, 11041283, 18480565, 12928106, 14754385, 22828014, 12504589, 19158416, 12408841, 16831414, 17245616, 18585048, 16271419, 11746426, 21151119, 19046381, 23321522, 16253995, 10830966, 16266284, 15951399, 16703529, 20088809, 15234100, 10576449, 21882281, 20416976, 12799020, 11274307, 17531386, 18983893, 12586549, 18322401, 16762377, 12507721, 18547680, 15246826, 22984283, 21570126, 23041110, 16554485, 23486571, 15778814, 16790543, 21161042, 15639548, 14679500, 12160938, 10656181, 17632276, 15265265, 12406183, 21933141, 12408226, 11924885, 15390159, 16020946, 10451383, 20921877, 11520901, 17913914, 14749132, 19769346, 16602060, 12914679, 21297271, 15824834, 10391466, 20205057, 19856923, 10321830, 17344052, 22589542, 17626162, 15224791, 21187584, 19240038, 10971616, 19704934, 16341942, 20493929, 18282567, 21174801, 22441986, 11430902, 16952411, 11489269, 23593992, 19828810, 15147906, 17678955, 18343551, 19891782, 16533397, 15649694, 18389097, 17141374, 22480599, 10624803, 17361039, 22646481, 12783435, 18790549, 20441786, 12695884, 12665676, 18819729, 19748514, 15952737, 23288567, 23537393, 12828500, 22820549, 19001528, 16625510, 15157062, 22391030, 16336218, 21051108, 11300106, 22129910, 18367167, 15314254, 11102478, 15721287, 15229249, 10507019, 15314245, 22660329, 21515512, 22351073, 22002427, 19757208, 17053873, 15003996, 21667571, 22894822, 21209855, 22718616, 11245929, 20969723, 19918059, 16583993, 16121144, 11524477, 22035587, 15940388, 20881126, 16940762, 12065636, 19355847, 23516295, 10847559, 22960314, 10568522, 12056923, 12938024, 17301224, 17389305, 12468047, 18392810, 19343058, 16364303, 22943908, 18408165],
                            "stats": {
                                "chiSquare": 810.69571889692,
                                "fisherExact": 2.199188630841e-102,
                                "fover": 4.0635863743457,
                                "qValue": 8.6071594630662e-99
                            },
                            "name": "Alzheimer Disease"
                        }, {
                            "identifier": "D006501",
                            "documentSet": [10966695, 15655660, 8102777, 10533796, 19085094, 1677585, 9096582, 7538300, 15779041, 19502650, 1673994, 11378875, 8855196, 18266634, 15836881, 9096616, 19067142, 16774619, 10555780, 8985263, 2866435, 9298855, 20609302, 2857496, 14678755, 17203513, 12083335, 14743457, 2873705, 19025766, 16212146, 10733542, 17924951, 1969494, 10198226, 10850549, 11092477, 8895955, 16265633, 16982110, 23466244, 11232201, 14699917, 9802491, 6150451, 6150706, 23168529, 11369436, 6125609, 19710544, 6142431, 9516569, 8776718, 6141134, 9286425, 7635424, 1967242, 11457595, 9286424, 8746768, 9361940, 11516427, 7911135, 19576960, 2888065, 22889958, 2886551, 19455124, 1970850, 8979252, 1687972, 20195723, 9699922, 1674207, 11415910, 11092576, 17342915, 11092581, 1684948, 1686998, 21698453, 7909784, 8096147, 16167197, 17218538, 15830303, 11252037, 8104085, 11787612, 20730316, 9459552, 7675012, 10206824, 1345760, 1345761, 6125994, 6131108, 10213478, 16497413],
                            "stats": {
                                "chiSquare": 325.64832633205,
                                "fisherExact": 7.651299046603e-38,
                                "fover": 5.0930302721896,
                                "qValue": 1.2325729295378e-34
                            },
                            "name": "Hepatic Encephalopathy"
                        }, {
                            "identifier": "D010300",
                            "documentSet": [23176288, 17315340, 10051230, 10777772, 15719139, 2863909, 14506445, 16613871, 11052221, 20082980, 7965038, 22363981, 20152107, 15858409, 21933141, 15140604, 19373115, 11396272, 16408282, 7931225, 2896652, 19012867, 12809698, 1350197, 9163944, 11577238, 7792721, 8838574, 19904002, 11683997, 16758479, 11387548, 19076369, 18682921, 18649387, 15006686, 18202920, 18937118, 9300430, 1684829, 20187249, 15893432, 11487204, 19520613, 9843162, 19520612, 1349466, 19815009, 19033459, 17907264, 20649576, 1361223, 23196983, 7475755, 1977410, 17215320, 16000145, 15003276, 19891782, 21232687, 10923988, 11470551, 10493400, 21731633, 12211136, 9523179, 23565852, 22075179, 1975653, 7692810, 16806272, 8615171, 10348313, 12442683, 1349276, 10991662, 8093682, 8094961, 17359492, 11307040, 2475945, 22583765, 8936453, 22351066, 15751039, 23421686, 12925011, 20651682, 7911652, 12373538, 23360507, 9159722, 22391030, 18554296, 15155524, 8099800, 20188048, 1353649, 10199613, 2874765, 10961664, 22088953, 9349670, 22936308, 15040076, 12373527, 7970002, 6117878, 18175396, 1695402, 17161393, 8880690, 2857118, 17245617, 16831414, 23128796, 21627638, 21323909, 10501216, 9195597, 9871444, 9871445, 16412990, 6145434, 15696422, 11136352, 17334978, 16596785, 16305461, 17084618, 6147219, 15996475, 12001656, 18570440, 6142089, 19124468, 9871434, 15326260, 1346548, 22108336, 10847559, 12434521, 20064468, 10907727, 11199809, 20041693, 17324517, 18952149, 8093582, 15341597, 8732541, 8093571, 9654378, 17265149, 21189560, 10989660, 9327987, 17235449],
                            "stats": {
                                "chiSquare": 48.344977877611,
                                "fisherExact": 2.2581373498759e-10,
                                "fover": 1.7269128581252,
                                "qValue": 1.116126569584e-7
                            },
                            "name": "Parkinson Disease"
                        }]
                    }, {
                        "name": "L-tyrosine",
                        "iupac": "L-tyrosine",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [21483460, 73858, 864384, 573062, 17081108, 1577224, 1967242, 7428585, 5411272, 807982, 2517893, 39973, 15139009, 39974, 21084134, 7260233, 6793024, 7178564, 781986, 4134293, 6403789, 5018083, 6111214, 6127593, 7136858, 7117780, 3784065, 113592, 6819667, 15908046, 22083566, 382661, 35649, 7532208, 24900, 2330597, 20583283, 21699073, 6424488, 6342443, 710854, 710855, 1404890, 501206, 17083474, 33494, 730076, 6260614, 772438, 2302019, 110563, 19904201, 7462424, 11490371, 4817189, 6150706, 4612790, 4612663, 90864, 19763802, 3926594, 16382339, 6797341, 47485],
                            "stats": {
                                "chiSquare": 74.112982462383,
                                "fisherExact": 1.0687304457441e-12,
                                "fover": 2.8009999992145,
                                "qValue": 6.3608589591883e-10
                            },
                            "name": "Hepatic Encephalopathy"
                        }, {
                            "identifier": "D010300",
                            "documentSet": [9203084, 6516067, 20972609, 4102972, 7651447, 18390556, 6849120, 5123908, 1146650, 6204498, 4120371, 7595645, 4844103, 18371080, 16643311, 7957867, 5308739, 4104492, 1787913, 10762167, 15282173, 22053701, 9390741, 5126994, 8527007, 23418747, 14756800, 8971433, 1252146, 11027850, 2713867, 10047930, 2713868, 3825692, 39974, 3606046, 19697948, 4324977, 22162019, 22136163, 6518609, 19855133, 16085186, 18692132, 16843835, 21041788, 5553940, 4341763, 10773222, 7566641, 4292871, 4091256, 4456974, 9670621, 1216860, 2476906, 4839449, 9285087, 11796199, 10517238, 4197142, 9520073, 5577485, 4926994, 4319516, 8351009, 17564755, 6442301, 10078971, 21533995, 4613157, 16210323, 12856480, 8440292, 6810882, 16929381, 10094845, 4885282, 6681870, 22863920, 20216409, 4944422, 4739109, 772708, 18093156, 3533125, 9600227, 9513952, 6987035, 11025626, 16604302, 1094755, 16014720, 15084435, 8612340, 4115783, 3352906, 1913700, 16932991, 4398909, 4226878, 1363050, 5418541, 5764823, 4936139, 21491910, 18069906, 4944072, 2502304, 8726541, 4987846, 1385624, 18520980, 16859791, 2760634, 5600452, 3574690, 21429212, 4120740, 6254020, 15909996, 11020342, 17353388, 4673250, 12534296, 22145021, 2586762, 21462263, 10552081, 4674038, 16450370, 4590072, 4994702, 7137962, 6150811, 12661766, 17900761, 4906882, 4402575, 1813974, 4103406, 15998245, 22776201, 7219901, 4911257, 10682228, 20356833, 16171820, 3150314, 11062131, 4082917, 22860160, 23503547, 6175872, 4616856, 8784230, 16516382, 17287139, 21092260, 10468218, 12435803, 1513457, 4720815, 9617786, 19647168, 10053234, 20399833, 12898346, 8474479, 4178641, 3930069, 10574926, 19049426, 3968972, 21766334, 23229334, 5125048, 15817478, 5122233, 12729915, 2685649, 2685650, 20083145, 5769891, 10803800, 5550505, 21638324, 1908962],
                            "stats": {
                                "chiSquare": 60.186599719776,
                                "fisherExact": 1.5398392858583e-12,
                                "fover": 1.7480878618286,
                                "qValue": 9.061205337695e-10
                            },
                            "name": "Parkinson Disease"
                        }, {
                            "identifier": "D000544",
                            "documentSet": [20084018, 23415649, 15231727, 15082222, 19251756, 15105263, 6204498, 15126504, 15006699, 21483094, 18439434, 10762167, 22745165, 16626667, 16078307, 9763459, 19606067, 15450355, 23788407, 8686745, 9452208, 18079026, 11162251, 10369213, 20110615, 20484629, 145709, 11312286, 12228233, 9472419, 11440793, 7681101, 18208556, 15786954, 16427207, 17112635, 16021692, 18005339, 22206488, 17050703, 12384247, 15091114, 14717612, 10754280, 17210450, 15850665, 301148, 16115884, 6117124, 15683253, 18547271, 12084708, 9092586, 21416485, 18448253, 20505437, 19542604, 12950178, 22057784, 16384915, 20609109, 21712440, 17055614, 10834395, 21514440, 18562203, 18353561, 12885573, 12885574, 15780468, 16924555, 21349839, 10875439, 21849536, 1385624, 11259429, 22959057, 19584443, 22355143, 16378731, 16651627, 19363261, 20441772, 15913839, 15663474, 22009041, 19809679, 17064357, 23428800, 16248658, 17433250, 15364419, 21903077, 19450500, 1708471, 19939230, 10821643, 10507022, 16519507, 12787059, 12425737, 8105420, 21454586, 20399861, 21794954, 20561151, 12073584, 15706662, 19897570, 14999081, 9605727, 7689658, 17145558, 16162853, 22049413, 17395167, 16201761, 20942567, 14642438, 11062131, 15817516, 1376245, 20472283, 22385841, 15165699, 11487050, 2494659, 21351586, 7537044, 15262209, 16815594, 16251420, 7505567, 7688325, 3968972, 23566485, 16216580, 17297919, 11019859, 18163432, 1705956],
                            "stats": {
                                "chiSquare": 15.341621729399,
                                "fisherExact": 0.00018032983756826,
                                "fover": 1.3887163969296,
                                "qValue": 0.041589634662976
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }, {
                        "name": "L-kynurenine",
                        "iupac": "L-kynurenine",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [10361374, 23630570, 16008823, 12396664, 10226937, 10821443, 20663292, 19457071, 1436703, 1385624, 20639188, 17023091, 23566485, 22939820, 19268309, 18201952, 8526997, 23192697, 10721050, 21441658, 20629991],
                            "stats": {
                                "chiSquare": 35.101432250713,
                                "fisherExact": 0.0000024072156341902,
                                "fover": 3.3752197702497,
                                "qValue": 0.00076276600085384
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }]
                }
            },
            "mappings": [{
                "name": "undefined",
                "data": []
            }],
            "object": "Metabolite",
            "targetLabel": "metaboliteDBIdentifier"
        };
        var ctrlMappingVizPanel = MetExplore.app.getController('MetExplore.controller.C_MappingVizPanel');

        ctrlMappingVizPanel.initHeatMap(mapping);
        expect(document.getElementById("panelViz").getElementsByClassName("kineticjs-content")).not.toBe(null);

        var menuSortByMetabolites = window.inchlib.target_element.find(".sort_menu").find('#sortbymetabolites')[0];
        var menuClustering = window.inchlib.target_element.find(".sort_menu").find('#clustering')[0];
        expect(menuSortByMetabolites).toBe(undefined);
        expect(menuClustering).toBe(undefined);

        var indexSortIcon = window.inchlib.navigation_layer.children.findIndex(function(kinetic) {
            return kinetic.id === 'sort_icon';
        });
        window.inchlib.navigation_layer.children[indexSortIcon].fire('click');

        menuSortByMetabolites = window.inchlib.target_element.find(".sort_menu").find('#sortbymetabolites')[0];
        menuClustering = window.inchlib.target_element.find(".sort_menu").find('#clustering')[0];
        expect(menuSortByMetabolites).not.toBe(undefined);
        expect(menuClustering).not.toBe(undefined);

        expect(window.inchlib.settings.column_dendrogram).toBe(true);
        expect(window.inchlib.heatmap_layer.children[0].children[27].partialText).toEqual("9");
        expect(window.inchlib.heatmap_layer.children[1].children[27].partialText).toEqual("4");
        expect(window.inchlib.heatmap_layer.children[2].children[27].partialText).toEqual("8");

        menuSortByMetabolites.click();

        setTimeout(function() {
            window.inchlib.header_layer.fire('click', {
                target: window.inchlib.header_layer.children[13]
            });
            expect(window.inchlib.settings.column_dendrogram).toBe(false);
            expect(window.inchlib.heatmap_layer.children[0].children[27].partialText).toEqual("9");
            expect(window.inchlib.heatmap_layer.children[1].children[27].partialText).toEqual("8");
            expect(window.inchlib.heatmap_layer.children[2].children[27].partialText).toEqual("4");

            menuClustering.click();
        }, 4000);
        setTimeout(function() {
            window.inchlib.header_layer.fire('click', {
                target: window.inchlib.header_layer.children[13]
            });
            expect(window.inchlib.settings.column_dendrogram).toBe(true);
            expect(window.inchlib.heatmap_layer.children[0].children[27].partialText).toEqual("9");
            expect(window.inchlib.heatmap_layer.children[1].children[27].partialText).toEqual("4");
            expect(window.inchlib.heatmap_layer.children[2].children[27].partialText).toEqual("8");
            done();
        }, 8000);
    });

    it('Test PubChem windowsinfo', function(done) {
        Ext.getCmp('mappingVizPanel').show();
        var mapping = {
            "name": "Metab2MeSH 3",
            "id": "M3",
            "data": {
                "meSHFromMetab4InCHlib": {
                    "metadata": {
                        "nodes": {
                            "panelViz#panelViz#0": ["4", "1.0"],
                            "panelViz#panelViz#1": ["9", "4.0"],
                            "panelViz#panelViz#2": ["8", "0.0"]
                        },
                        "feature_names": ["Number of metabolites", "Articles ratio"]
                    },
                    "data": {
                        "nodes": {
                            "panelViz#panelViz#0": {
                                "features": [0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0],
                                "parent": "panelViz#panelViz#3",
                                "distance": 0,
                                "objects": ["Parkinson Disease"],
                                "count": 1
                            },
                            "panelViz#panelViz#1": {
                                "features": [0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                                "parent": "panelViz#panelViz#4",
                                "distance": 0,
                                "objects": ["Hepatic Encephalopathy"],
                                "count": 1
                            },
                            "panelViz#panelViz#2": {
                                "features": [1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0],
                                "parent": "panelViz#panelViz#3",
                                "distance": 0,
                                "objects": ["Alzheimer Disease"],
                                "count": 1
                            },
                            "panelViz#panelViz#3": {
                                "parent": "panelViz#panelViz#4",
                                "left_child": "panelViz#panelViz#0",
                                "distance": 2.449,
                                "right_child": "panelViz#panelViz#2",
                                "count": 2
                            },
                            "panelViz#panelViz#4": {
                                "left_child": "panelViz#panelViz#1",
                                "distance": 2.708,
                                "right_child": "panelViz#panelViz#3",
                                "count": 3
                            }
                        },
                        "feature_names": ["L-threonine", "5-oxoprolinate", "L-kynurenine", "5-hydroxy-L-tryptophan", "O-acetylcarnitine", "L-methionine", "L-glutamate(1-)", "5-Hydroxyindoleacetate", "L-tyrosine", "L-Octanoylcarnitine", "L-phenylalanine", "L-tryptophan", "citr_L[e]"]
                    },
                    "column_dendrogram": {
                        "nodes": {
                            "panelViz#panelViz#0": {
                                "parent": "panelViz#panelViz#13",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#1": {
                                "parent": "panelViz#panelViz#22",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#2": {
                                "parent": "panelViz#panelViz#20",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#3": {
                                "parent": "panelViz#panelViz#13",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#4": {
                                "parent": "panelViz#panelViz#14",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#5": {
                                "parent": "panelViz#panelViz#15",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#6": {
                                "parent": "panelViz#panelViz#15",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#7": {
                                "parent": "panelViz#panelViz#20",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#8": {
                                "parent": "panelViz#panelViz#16",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#9": {
                                "parent": "panelViz#panelViz#17",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#10": {
                                "parent": "panelViz#panelViz#16",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#11": {
                                "parent": "panelViz#panelViz#18",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#12": {
                                "parent": "panelViz#panelViz#19",
                                "distance": 0,
                                "count": 1
                            },
                            "panelViz#panelViz#13": {
                                "parent": "panelViz#panelViz#14",
                                "left_child": "panelViz#panelViz#0",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#3",
                                "count": 2
                            },
                            "panelViz#panelViz#14": {
                                "parent": "panelViz#panelViz#17",
                                "left_child": "panelViz#panelViz#4",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#13",
                                "count": 3
                            },
                            "panelViz#panelViz#15": {
                                "parent": "panelViz#panelViz#19",
                                "left_child": "panelViz#panelViz#5",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#6",
                                "count": 2
                            },
                            "panelViz#panelViz#16": {
                                "parent": "panelViz#panelViz#18",
                                "left_child": "panelViz#panelViz#8",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#10",
                                "count": 2
                            },
                            "panelViz#panelViz#17": {
                                "parent": "panelViz#panelViz#24",
                                "left_child": "panelViz#panelViz#9",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#14",
                                "count": 4
                            },
                            "panelViz#panelViz#18": {
                                "parent": "panelViz#panelViz#21",
                                "left_child": "panelViz#panelViz#11",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#16",
                                "count": 3
                            },
                            "panelViz#panelViz#19": {
                                "parent": "panelViz#panelViz#22",
                                "left_child": "panelViz#panelViz#12",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#15",
                                "count": 3
                            },
                            "panelViz#panelViz#20": {
                                "parent": "panelViz#panelViz#21",
                                "left_child": "panelViz#panelViz#2",
                                "distance": 0,
                                "right_child": "panelViz#panelViz#7",
                                "count": 2
                            },
                            "panelViz#panelViz#21": {
                                "parent": "panelViz#panelViz#23",
                                "left_child": "panelViz#panelViz#18",
                                "distance": 1.549,
                                "right_child": "panelViz#panelViz#20",
                                "count": 5
                            },
                            "panelViz#panelViz#22": {
                                "parent": "panelViz#panelViz#23",
                                "left_child": "panelViz#panelViz#1",
                                "distance": 1.732,
                                "right_child": "panelViz#panelViz#19",
                                "count": 4
                            },
                            "panelViz#panelViz#23": {
                                "parent": "panelViz#panelViz#24",
                                "left_child": "panelViz#panelViz#21",
                                "distance": 2.295,
                                "right_child": "panelViz#panelViz#22",
                                "count": 9
                            },
                            "panelViz#panelViz#24": {
                                "left_child": "panelViz#panelViz#17",
                                "distance": 2.562,
                                "right_child": "panelViz#panelViz#23",
                                "count": 13
                            }
                        }
                    }
                },
                "pubmed": {
                    "metabolites": [{
                        "name": "L-phenylalanine",
                        "iupac": "L-phenylalanine",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [7532208, 73858, 2330597, 11092576, 6424488, 101451, 710854, 864384, 573062, 1404890, 1577224, 730076, 7428585, 399583, 5411272, 8514271, 2302019, 807982, 110563, 2517893, 1352048, 8480740, 7095369, 6793024, 7643101, 4134293, 11490371, 4817189, 333224, 4612790, 4612663, 90864, 6127593, 4722749, 741885, 7117780, 3784065, 3926594, 113592, 6797341, 47485],
                            "stats": {
                                "chiSquare": 69.941783736096,
                                "fisherExact": 4.1383048818721e-11,
                                "fover": 3.412890391345,
                                "qValue": 2.1770625765323e-8
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "5-hydroxy-L-tryptophan",
                        "iupac": "5-hydroxy-L-tryptophan",
                        "meshs": [{
                            "identifier": "D010300",
                            "documentSet": [4936139, 10773222, 5312403, 3484854, 9295177, 6814755, 5311767, 3538162, 201156, 4538893, 11685243, 4403657, 6997735, 2428139, 5308096, 5308739, 2265910, 6801200, 1918474, 6999, 787922, 4563493, 2461509, 4546593, 4401063, 5310324, 4541856, 9182250, 4548770, 4574253, 4923106, 4604074, 4134163, 4358575, 4944741, 772708, 7682308, 4280243, 4098060, 4889342, 2962265, 3493632, 1079721, 5316906, 1080107, 8101703, 4590072, 4226878],
                            "stats": {
                                "chiSquare": 128.01283662306,
                                "fisherExact": 6.9948837140476e-17,
                                "fover": 4.4418001491716,
                                "qValue": 5.3974606466477e-14
                            },
                            "name": "Parkinson Disease"
                        }]
                    }, {
                        "name": "L-methionine",
                        "iupac": "L-methionine",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [5050317, 6516898, 4932106, 21483460, 908872, 14146640, 6394027, 6107671, 101451, 2993889, 1079900, 1999315, 864384, 573062, 1404890, 335882, 6985598, 1155716, 685343, 347920, 5444996, 121878, 3168296, 3710497, 3114036, 6286400, 4829865, 807982, 3912338, 4134293, 6698445, 1529276, 4817189, 3736469, 14174581, 333224, 7106499, 109939, 2857496, 6127593, 741885, 6519636, 113592, 6797341, 47485],
                            "stats": {
                                "chiSquare": 69.942806612549,
                                "fisherExact": 2.3947581895503e-11,
                                "fover": 3.2462354646765,
                                "qValue": 1.2840409722323e-8
                            },
                            "name": "Hepatic Encephalopathy"
                        }, {
                            "identifier": "D000544",
                            "documentSet": [15809266, 10535332, 18387741, 10588580, 23399523, 18468894, 16298495, 15605990, 11795896, 22918225, 15843069, 9712537, 22531416, 20209467, 17413657, 20613678, 16517609, 22573634, 15843052, 16627933, 15635660, 12611557, 15505374, 14730194, 22890094, 10096041, 8838581, 8621744, 15680219, 7890753, 21297272, 17169464, 16472763, 17657167, 9007311, 9746908, 1534813, 11228134, 22059533, 17691219, 23769397, 22500616, 15622541, 12198111, 1661822, 22045496, 7991571, 12446928, 12446930, 18460776, 22584618, 15838855, 15970929, 14580313, 3574449, 22150111, 12607822, 10097173, 2116015, 7715815, 19854267, 23249141, 16917144, 15172733, 15172732, 15172731, 1535413, 16248658, 16839078, 17101228, 8224467, 19504537, 10507025, 14520676, 20555139, 15025502, 20453509, 1649369, 15203119, 15706662, 18804692, 20164095, 20590839, 8239282, 19924451, 12752408, 8131745, 17046756, 16962786, 19061952, 10509380, 11403592, 8621419, 12128086, 21054384, 18439912, 8098953, 16837108, 14599209, 23445400, 7798921],
                            "stats": {
                                "chiSquare": 25.202932137765,
                                "fisherExact": 0.0000036623565035302,
                                "fover": 1.6396463781627,
                                "qValue": 0.0011295975774346
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }, {
                        "name": "L-Octanoylcarnitine",
                        "iupac": "L-Octanoylcarnitine",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [8194797, 2805707, 2703758, 2813970, 6097201, 8611661, 7118066, 6693016, 3033057],
                            "stats": {
                                "chiSquare": 131.46576488545,
                                "fisherExact": 6.7509466673616e-9,
                                "fover": 16.546872829518,
                                "qValue": 0.0000028987915722408
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "L-tryptophan",
                        "iupac": "L-tryptophan",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [2419500, 467210, 7685732, 396563, 6848895, 10916286, 12171172, 1763335, 5921860, 10522754, 807982, 7095369, 39973, 7075404, 6793024, 4608353, 15094220, 447020, 14058237, 107058, 12220301, 3791875, 6200419, 8887992, 676917, 3693432, 35649, 2430055, 48706, 18333523, 6244122, 101451, 6342443, 620892, 9652676, 676688, 3747417, 2302019, 1352048, 49767, 14140862, 4817189, 6160435, 6184497, 2158415, 2973276, 966012, 7216152, 48764, 47485, 9869330, 9588757, 1141919, 573062, 7428585, 9286423, 5411272, 2517893, 3912338, 781986, 7098049, 333224, 8906295, 8906294, 6111214, 290743, 6127593, 10164, 4590835, 7454151, 10721051, 16215883, 8869946, 6793946, 10721053, 6162912, 10721052, 382661, 7532208, 426181, 6394027, 710849, 2993889, 26572, 33231, 53461, 33494, 5444996, 399583, 6622904, 4829865, 5122221, 17169376, 17712616, 2793414, 7675013, 4612790, 90864, 14567468, 11137885, 4009921],
                            "stats": {
                                "chiSquare": 452.30134350369,
                                "fisherExact": 1.9251697607781e-46,
                                "fover": 6.3200033598141,
                                "qValue": 3.7346492172426e-43
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "5-oxoprolinate",
                        "iupac": "L-Pyroglutamic acid",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [21900558, 23001756, 20864186, 12354296, 23747948, 19518051, 11027491, 20971852, 21148560, 20833262, 22232007, 22064070, 1904138, 22375951, 19781815, 18570439, 22267726, 19545911, 22712644, 11162251, 21301857, 8971693, 22001577, 21965666, 20383514, 9224700, 23481684, 18836460, 22343072, 22800366, 22269161, 21787313, 19823761, 3090448],
                            "stats": {
                                "chiSquare": 115.13713675152,
                                "fisherExact": 2.7933470168397e-14,
                                "fover": 5.1938510100396,
                                "qValue": 1.8497259704969e-11
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }, {
                        "name": "L-threonine",
                        "iupac": "L-threonine",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [18187157, 16298235, 12196665, 11310639, 10614182, 20683187, 16801675, 20558388, 20033852, 15157994, 11517218, 15126504, 19584443, 16262633, 8793108, 18987186, 16399209, 1644173, 10863026, 12962909, 19363261, 14665412, 21433051, 21883216, 12562590, 9546672, 8835879, 17250725, 19524111, 15488330, 16443603, 15312964, 19307538, 19011737, 11118482, 11146006, 16554819, 11882743, 12759172, 17183681, 15936948, 19770469, 18005339, 12614922, 12164722, 9085254, 15126697, 16738478, 17431643, 22112898, 18508489, 10677623, 15316799, 15272895, 9357016, 20126313, 14575236, 18045903, 8131745, 7786411, 19296504, 16257959, 16705182, 16195223, 17906291, 10341243, 21123754, 8621419, 21220649, 15883264, 21712440, 17448572, 15838855, 16364302, 21084733, 16697218, 15635602],
                            "stats": {
                                "chiSquare": 126.84250302093,
                                "fisherExact": 5.4965376658283e-19,
                                "fover": 3.3486801143319,
                                "qValue": 4.7253567312869e-16
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }, {
                        "name": "O-acetylcarnitine",
                        "iupac": "Acetyl-L-carnitine",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [22027664, 18042001, 2630254, 1444880, 12841930, 12661320, 15591008, 7908343, 21978079, 19185780, 20359271, 11126392, 9677506, 15236794, 17210450, 2178869, 19342064, 18646596, 1630720, 1944900, 8797468, 2690098, 8477148, 1541322, 12598816, 12804452, 23072393, 14624946, 7723928, 16634066, 8666027, 2121359, 8380879, 16402761, 18761385, 10994000, 10608918, 8239306, 1482095, 2792144, 16621446, 1776743, 11171924, 6345054],
                            "stats": {
                                "chiSquare": 629.2547496674,
                                "fisherExact": 1.234647728404e-37,
                                "fover": 16.239666692131,
                                "qValue": 1.9791325489379e-34
                            },
                            "name": "Alzheimer Disease"
                        }, {
                            "identifier": "D006501",
                            "documentSet": [23389620, 20359271, 19357525, 18357530, 21870121, 21310833, 21443422, 17080254, 16445703],
                            "stats": {
                                "chiSquare": 115.45562366204,
                                "fisherExact": 1.7872395525234e-8,
                                "fover": 14.760654957833,
                                "qValue": 0.0000073443025849571
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "5-Hydroxyindoleacetate",
                        "iupac": "5-Hydroxyindole-3-acetic acid",
                        "meshs": [{
                            "identifier": "D010300",
                            "documentSet": [5668438, 5151306, 4261957, 22902616, 6204498, 2435113, 4844103, 942621, 874521, 1705999, 4712542, 827925, 2428421, 11109003, 1091122, 4114458, 2424323, 2409485, 15159499, 5436031, 745018, 6198888, 4845694, 2581531, 6173792, 4262400, 2456674, 7527483, 4715017, 4120687, 4109932, 4282386, 11144958, 2578558, 2446463, 4563493, 10078971, 4546593, 591981, 2475587, 138340, 138341, 4836896, 2421838, 130667, 1372794, 7505410, 4792890, 968312, 6159908, 5658324, 1690267, 2579626, 4666057, 2579625, 570014, 5083866, 134293, 4668639, 15133823, 10078727, 727726, 2581135, 5084388, 11697688, 4858086, 4117647, 1716905, 5556449, 5571307, 18164694, 4281484, 9620060, 9546335, 2428139, 4275348, 6175872, 4616856, 5062828, 2420928, 4270247, 5061285, 4912291, 132845, 4643007, 2480863, 1700581, 1700583, 6172833, 4854088, 20945980, 4785998, 2582318, 2475820, 1146650, 1693975, 4556618, 5580101, 5032285, 5308739, 6182730, 20347948, 4279131, 577299, 907536, 6172024, 4550499, 2435855, 2439947, 6206831, 4763001, 1146660, 9608612, 1080107, 17956909, 11430895, 4270339, 4121468, 5311767, 6085395, 2476906, 5534981, 5133599, 4557584, 4746526, 1283403, 4821783, 6035772, 2461509, 1723256, 5146413, 5892413, 6192438, 5132580, 4716845, 5949239, 1096575, 7682308, 4371255, 8811504, 4930867, 1222507, 5450542, 241026, 4448192, 6164951, 2423726, 1705356, 17973898, 4257247, 6157311, 4699106, 147372, 930747, 4256760, 21376255, 862646, 19844754, 5808100, 4210686, 1088942, 6200801, 569783, 141763, 5312403, 2480103, 1712088, 9295177, 2476003, 201156, 18207455, 4653961, 5424003, 4553111, 4263829, 4125162, 1378766, 5281200, 4930475, 7521168, 1688571, 2421191, 8684384, 4565920, 4541856, 9617786, 4472237, 1374203, 5588903, 4280243, 4822972, 6161320, 843258, 7688076, 8836986, 2482649, 1718247, 9184114],
                            "stats": {
                                "chiSquare": 1304.8857169267,
                                "fisherExact": 2.884803396916e-111,
                                "fover": 8.4723002031853,
                                "qValue": 1.2115802570343e-107
                            },
                            "name": "Parkinson Disease"
                        }, {
                            "identifier": "D000544",
                            "documentSet": [16182262, 7690228, 1710105, 2478368, 2440994, 83462, 2419502, 14671188, 6084823, 2440238, 6204498, 6208336, 6200784, 2579625, 2481322, 2428341, 33427, 10666678, 2432177, 2471986, 1001240, 2580668, 15996137, 6085697, 1713799, 2409733, 1705151, 2450445, 2477071, 2434191, 2457353, 1707190, 1697333, 2439947, 16955437, 6204017, 6195313, 1283363, 2436247, 1701291, 6204013, 8800434, 12218255, 2414354, 6205414, 6157799, 1698467, 2581531, 2474777, 2421656, 2480103, 1714776, 1381590, 2461537, 1719135, 1695580, 9678683, 6172950, 2411246, 12411761, 1707735, 7566524, 6184590, 2415092, 2477044, 7679142, 2451190, 2425718, 1712206, 6181768, 2582256, 1691969, 301148, 1378766, 7510447, 1371850, 7539116, 2452858, 2452037, 15665806, 1723256, 1723257, 2462403, 22045496, 1109880, 6203954, 1716470, 9063908, 2445515, 8627315, 9880039, 1709421, 2480863, 1381103, 1281646],
                            "stats": {
                                "chiSquare": 241.10975497487,
                                "fisherExact": 9.2201456582053e-31,
                                "fover": 4.3057498360277,
                                "qValue": 1.2325184584733e-27
                            },
                            "name": "Alzheimer Disease"
                        }, {
                            "identifier": "D006501",
                            "documentSet": [2482533, 35649, 7532208, 2430055, 426181, 9869330, 9588757, 11575864, 6186774, 2419500, 1698704, 1285400, 26572, 6161235, 2472360, 1141919, 7685732, 754526, 9403225, 33494, 676688, 9789710, 12171172, 39973, 9346471, 2412877, 15094220, 9346468, 4817189, 6160435, 6184497, 236851, 8906294, 2448852, 966012, 2480534, 290743, 11137885, 925688, 2426719, 8869946, 6200419, 6162912, 676917],
                            "stats": {
                                "chiSquare": 306.87954886153,
                                "fisherExact": 9.4013437634163e-27,
                                "fover": 8.8616899077342,
                                "qValue": 1.1066250052098e-23
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "citr_L[e]",
                        "iupac": "L-citrulline",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [7909784, 21483460, 5762228, 11606680, 10078035, 2692930, 8474573, 8840235, 7699832, 864384, 18414167, 4999165, 6513111, 1017595, 7192757, 9361940, 3088083, 1795430],
                            "stats": {
                                "chiSquare": 130.60159333483,
                                "fisherExact": 4.4648859956382e-12,
                                "fover": 9.1463103691286,
                                "qValue": 2.5372845665491e-9
                            },
                            "name": "Hepatic Encephalopathy"
                        }]
                    }, {
                        "name": "L-glutamate(1-)",
                        "iupac": "L-glutamic acid",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [12391609, 14664921, 10735269, 20936504, 22992724, 16714485, 16033022, 18431250, 16033023, 22511962, 10428049, 10428048, 20362023, 18648325, 11442356, 12391586, 15201479, 19012867, 17372971, 20193040, 19903243, 19943189, 16828202, 16515283, 19076369, 18483490, 11218066, 22233455, 21914482, 12768511, 23891752, 20961659, 22133015, 17257792, 14501018, 13130383, 15585443, 18042177, 16809810, 19501936, 18183499, 19110209, 11948244, 11142345, 22515507, 11053772, 19833161, 15857305, 15003276, 19339596, 16772755, 16039064, 18376053, 12697263, 12973748, 22515493, 21921084, 17569662, 18053990, 22112551, 15718040, 12973746, 11391701, 12835512, 21389115, 14677087, 15949941, 21880261, 19221420, 10875439, 18950575, 17433503, 14980721, 20345761, 20444591, 23776240, 12501538, 16802718, 19850126, 22015470, 23156675, 11483660, 22710270, 10627591, 11825682, 15304259, 11041283, 18480565, 12928106, 14754385, 22828014, 12504589, 19158416, 12408841, 16831414, 17245616, 18585048, 16271419, 11746426, 21151119, 19046381, 23321522, 16253995, 10830966, 16266284, 15951399, 16703529, 20088809, 15234100, 10576449, 21882281, 20416976, 12799020, 11274307, 17531386, 18983893, 12586549, 18322401, 16762377, 12507721, 18547680, 15246826, 22984283, 21570126, 23041110, 16554485, 23486571, 15778814, 16790543, 21161042, 15639548, 14679500, 12160938, 10656181, 17632276, 15265265, 12406183, 21933141, 12408226, 11924885, 15390159, 16020946, 10451383, 20921877, 11520901, 17913914, 14749132, 19769346, 16602060, 12914679, 21297271, 15824834, 10391466, 20205057, 19856923, 10321830, 17344052, 22589542, 17626162, 15224791, 21187584, 19240038, 10971616, 19704934, 16341942, 20493929, 18282567, 21174801, 22441986, 11430902, 16952411, 11489269, 23593992, 19828810, 15147906, 17678955, 18343551, 19891782, 16533397, 15649694, 18389097, 17141374, 22480599, 10624803, 17361039, 22646481, 12783435, 18790549, 20441786, 12695884, 12665676, 18819729, 19748514, 15952737, 23288567, 23537393, 12828500, 22820549, 19001528, 16625510, 15157062, 22391030, 16336218, 21051108, 11300106, 22129910, 18367167, 15314254, 11102478, 15721287, 15229249, 10507019, 15314245, 22660329, 21515512, 22351073, 22002427, 19757208, 17053873, 15003996, 21667571, 22894822, 21209855, 22718616, 11245929, 20969723, 19918059, 16583993, 16121144, 11524477, 22035587, 15940388, 20881126, 16940762, 12065636, 19355847, 23516295, 10847559, 22960314, 10568522, 12056923, 12938024, 17301224, 17389305, 12468047, 18392810, 19343058, 16364303, 22943908, 18408165],
                            "stats": {
                                "chiSquare": 810.69571889692,
                                "fisherExact": 2.199188630841e-102,
                                "fover": 4.0635863743457,
                                "qValue": 8.6071594630662e-99
                            },
                            "name": "Alzheimer Disease"
                        }, {
                            "identifier": "D006501",
                            "documentSet": [10966695, 15655660, 8102777, 10533796, 19085094, 1677585, 9096582, 7538300, 15779041, 19502650, 1673994, 11378875, 8855196, 18266634, 15836881, 9096616, 19067142, 16774619, 10555780, 8985263, 2866435, 9298855, 20609302, 2857496, 14678755, 17203513, 12083335, 14743457, 2873705, 19025766, 16212146, 10733542, 17924951, 1969494, 10198226, 10850549, 11092477, 8895955, 16265633, 16982110, 23466244, 11232201, 14699917, 9802491, 6150451, 6150706, 23168529, 11369436, 6125609, 19710544, 6142431, 9516569, 8776718, 6141134, 9286425, 7635424, 1967242, 11457595, 9286424, 8746768, 9361940, 11516427, 7911135, 19576960, 2888065, 22889958, 2886551, 19455124, 1970850, 8979252, 1687972, 20195723, 9699922, 1674207, 11415910, 11092576, 17342915, 11092581, 1684948, 1686998, 21698453, 7909784, 8096147, 16167197, 17218538, 15830303, 11252037, 8104085, 11787612, 20730316, 9459552, 7675012, 10206824, 1345760, 1345761, 6125994, 6131108, 10213478, 16497413],
                            "stats": {
                                "chiSquare": 325.64832633205,
                                "fisherExact": 7.651299046603e-38,
                                "fover": 5.0930302721896,
                                "qValue": 1.2325729295378e-34
                            },
                            "name": "Hepatic Encephalopathy"
                        }, {
                            "identifier": "D010300",
                            "documentSet": [23176288, 17315340, 10051230, 10777772, 15719139, 2863909, 14506445, 16613871, 11052221, 20082980, 7965038, 22363981, 20152107, 15858409, 21933141, 15140604, 19373115, 11396272, 16408282, 7931225, 2896652, 19012867, 12809698, 1350197, 9163944, 11577238, 7792721, 8838574, 19904002, 11683997, 16758479, 11387548, 19076369, 18682921, 18649387, 15006686, 18202920, 18937118, 9300430, 1684829, 20187249, 15893432, 11487204, 19520613, 9843162, 19520612, 1349466, 19815009, 19033459, 17907264, 20649576, 1361223, 23196983, 7475755, 1977410, 17215320, 16000145, 15003276, 19891782, 21232687, 10923988, 11470551, 10493400, 21731633, 12211136, 9523179, 23565852, 22075179, 1975653, 7692810, 16806272, 8615171, 10348313, 12442683, 1349276, 10991662, 8093682, 8094961, 17359492, 11307040, 2475945, 22583765, 8936453, 22351066, 15751039, 23421686, 12925011, 20651682, 7911652, 12373538, 23360507, 9159722, 22391030, 18554296, 15155524, 8099800, 20188048, 1353649, 10199613, 2874765, 10961664, 22088953, 9349670, 22936308, 15040076, 12373527, 7970002, 6117878, 18175396, 1695402, 17161393, 8880690, 2857118, 17245617, 16831414, 23128796, 21627638, 21323909, 10501216, 9195597, 9871444, 9871445, 16412990, 6145434, 15696422, 11136352, 17334978, 16596785, 16305461, 17084618, 6147219, 15996475, 12001656, 18570440, 6142089, 19124468, 9871434, 15326260, 1346548, 22108336, 10847559, 12434521, 20064468, 10907727, 11199809, 20041693, 17324517, 18952149, 8093582, 15341597, 8732541, 8093571, 9654378, 17265149, 21189560, 10989660, 9327987, 17235449],
                            "stats": {
                                "chiSquare": 48.344977877611,
                                "fisherExact": 2.2581373498759e-10,
                                "fover": 1.7269128581252,
                                "qValue": 1.116126569584e-7
                            },
                            "name": "Parkinson Disease"
                        }]
                    }, {
                        "name": "L-tyrosine",
                        "iupac": "L-tyrosine",
                        "meshs": [{
                            "identifier": "D006501",
                            "documentSet": [21483460, 73858, 864384, 573062, 17081108, 1577224, 1967242, 7428585, 5411272, 807982, 2517893, 39973, 15139009, 39974, 21084134, 7260233, 6793024, 7178564, 781986, 4134293, 6403789, 5018083, 6111214, 6127593, 7136858, 7117780, 3784065, 113592, 6819667, 15908046, 22083566, 382661, 35649, 7532208, 24900, 2330597, 20583283, 21699073, 6424488, 6342443, 710854, 710855, 1404890, 501206, 17083474, 33494, 730076, 6260614, 772438, 2302019, 110563, 19904201, 7462424, 11490371, 4817189, 6150706, 4612790, 4612663, 90864, 19763802, 3926594, 16382339, 6797341, 47485],
                            "stats": {
                                "chiSquare": 74.112982462383,
                                "fisherExact": 1.0687304457441e-12,
                                "fover": 2.8009999992145,
                                "qValue": 6.3608589591883e-10
                            },
                            "name": "Hepatic Encephalopathy"
                        }, {
                            "identifier": "D010300",
                            "documentSet": [9203084, 6516067, 20972609, 4102972, 7651447, 18390556, 6849120, 5123908, 1146650, 6204498, 4120371, 7595645, 4844103, 18371080, 16643311, 7957867, 5308739, 4104492, 1787913, 10762167, 15282173, 22053701, 9390741, 5126994, 8527007, 23418747, 14756800, 8971433, 1252146, 11027850, 2713867, 10047930, 2713868, 3825692, 39974, 3606046, 19697948, 4324977, 22162019, 22136163, 6518609, 19855133, 16085186, 18692132, 16843835, 21041788, 5553940, 4341763, 10773222, 7566641, 4292871, 4091256, 4456974, 9670621, 1216860, 2476906, 4839449, 9285087, 11796199, 10517238, 4197142, 9520073, 5577485, 4926994, 4319516, 8351009, 17564755, 6442301, 10078971, 21533995, 4613157, 16210323, 12856480, 8440292, 6810882, 16929381, 10094845, 4885282, 6681870, 22863920, 20216409, 4944422, 4739109, 772708, 18093156, 3533125, 9600227, 9513952, 6987035, 11025626, 16604302, 1094755, 16014720, 15084435, 8612340, 4115783, 3352906, 1913700, 16932991, 4398909, 4226878, 1363050, 5418541, 5764823, 4936139, 21491910, 18069906, 4944072, 2502304, 8726541, 4987846, 1385624, 18520980, 16859791, 2760634, 5600452, 3574690, 21429212, 4120740, 6254020, 15909996, 11020342, 17353388, 4673250, 12534296, 22145021, 2586762, 21462263, 10552081, 4674038, 16450370, 4590072, 4994702, 7137962, 6150811, 12661766, 17900761, 4906882, 4402575, 1813974, 4103406, 15998245, 22776201, 7219901, 4911257, 10682228, 20356833, 16171820, 3150314, 11062131, 4082917, 22860160, 23503547, 6175872, 4616856, 8784230, 16516382, 17287139, 21092260, 10468218, 12435803, 1513457, 4720815, 9617786, 19647168, 10053234, 20399833, 12898346, 8474479, 4178641, 3930069, 10574926, 19049426, 3968972, 21766334, 23229334, 5125048, 15817478, 5122233, 12729915, 2685649, 2685650, 20083145, 5769891, 10803800, 5550505, 21638324, 1908962],
                            "stats": {
                                "chiSquare": 60.186599719776,
                                "fisherExact": 1.5398392858583e-12,
                                "fover": 1.7480878618286,
                                "qValue": 9.061205337695e-10
                            },
                            "name": "Parkinson Disease"
                        }, {
                            "identifier": "D000544",
                            "documentSet": [20084018, 23415649, 15231727, 15082222, 19251756, 15105263, 6204498, 15126504, 15006699, 21483094, 18439434, 10762167, 22745165, 16626667, 16078307, 9763459, 19606067, 15450355, 23788407, 8686745, 9452208, 18079026, 11162251, 10369213, 20110615, 20484629, 145709, 11312286, 12228233, 9472419, 11440793, 7681101, 18208556, 15786954, 16427207, 17112635, 16021692, 18005339, 22206488, 17050703, 12384247, 15091114, 14717612, 10754280, 17210450, 15850665, 301148, 16115884, 6117124, 15683253, 18547271, 12084708, 9092586, 21416485, 18448253, 20505437, 19542604, 12950178, 22057784, 16384915, 20609109, 21712440, 17055614, 10834395, 21514440, 18562203, 18353561, 12885573, 12885574, 15780468, 16924555, 21349839, 10875439, 21849536, 1385624, 11259429, 22959057, 19584443, 22355143, 16378731, 16651627, 19363261, 20441772, 15913839, 15663474, 22009041, 19809679, 17064357, 23428800, 16248658, 17433250, 15364419, 21903077, 19450500, 1708471, 19939230, 10821643, 10507022, 16519507, 12787059, 12425737, 8105420, 21454586, 20399861, 21794954, 20561151, 12073584, 15706662, 19897570, 14999081, 9605727, 7689658, 17145558, 16162853, 22049413, 17395167, 16201761, 20942567, 14642438, 11062131, 15817516, 1376245, 20472283, 22385841, 15165699, 11487050, 2494659, 21351586, 7537044, 15262209, 16815594, 16251420, 7505567, 7688325, 3968972, 23566485, 16216580, 17297919, 11019859, 18163432, 1705956],
                            "stats": {
                                "chiSquare": 15.341621729399,
                                "fisherExact": 0.00018032983756826,
                                "fover": 1.3887163969296,
                                "qValue": 0.041589634662976
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }, {
                        "name": "L-kynurenine",
                        "iupac": "L-kynurenine",
                        "meshs": [{
                            "identifier": "D000544",
                            "documentSet": [10361374, 23630570, 16008823, 12396664, 10226937, 10821443, 20663292, 19457071, 1436703, 1385624, 20639188, 17023091, 23566485, 22939820, 19268309, 18201952, 8526997, 23192697, 10721050, 21441658, 20629991],
                            "stats": {
                                "chiSquare": 35.101432250713,
                                "fisherExact": 0.0000024072156341902,
                                "fover": 3.3752197702497,
                                "qValue": 0.00076276600085384
                            },
                            "name": "Alzheimer Disease"
                        }]
                    }]
                }
            },
            "mappings": [{
                "name": "undefined",
                "data": []
            }],
            "object": "Metabolite",
            "targetLabel": "metaboliteDBIdentifier"
        };
        var ctrlMappingVizPanel = MetExplore.app.getController('MetExplore.controller.C_MappingVizPanel');

        ctrlMappingVizPanel.initHeatMap(mapping);
        expect(document.getElementById("panelViz").getElementsByClassName("kineticjs-content")).not.toBe(null);
        setTimeout(function() {
            window.inchlib.header_layer.fire('click', {
                target: window.inchlib.header_layer.children[6]
            });
            done();
        }, 8000);
    });
});

describe('Test external APIs', function() {

    var originalTimeout;

    beforeEach(function() {
        originalTimeout = jasmine.DEFAULT_TIMEOUT_INTERVAL;
        jasmine.DEFAULT_TIMEOUT_INTERVAL = 20000;
    });

    afterEach(function() {
        jasmine.DEFAULT_TIMEOUT_INTERVAL = originalTimeout;
    });


    // it('Test PubMed API', function(done) {
    //
    //     $.ajax({
    //         url: "https://www.ncbi.nlm.nih.gov/pubmed?term=L-methionine",
    //         context: document.body,
    //         header: {
    //             "X-Requested-With": "XMLHttpRequest",
    //             "Access-Control-Allow-Origin": "localhost"
    //         }
    //     }).done(function() {
    //         expect(true).toBeTruthy();
    //         done();
    //     }).fail(function() {
    //         expect(false).toBeTruthy();
    //         done();
    //     });
    // });

    it('Test MeSH API', function(done) {
        $.get("https://meshb.nlm.nih.gov/search?searchInField=allTerms&sort=&size=20&searchType=exactMatch&searchMethod=FullWord&q=L-methionine").done(function() {
            expect(true).toBeTruthy();
            done();
        }).fail(function(rep) {
            expect(false).toBeTruthy();
            done();
        });
    });

    it('Test Med By Year API', function(done) {
        $.get("https://med-by-year.appspot.com/search?q=L-methionine").done(function() {
            expect(true).toBeTruthy();
            done();
        }).fail(function() {
            expect(false).toBeTruthy();
            done();
        });
    });
});